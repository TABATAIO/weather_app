<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ğŸ§ª ãƒã‚¹ã‚³ãƒƒãƒˆAPI ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; padding: 20px; background: #f5f5f5; }
        .test-section { margin: 20px 0; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        button { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { margin-top: 10px; padding: 10px; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; white-space: pre-wrap; }
        .success { border-color: #28a745; background-color: #d4edda; color: #155724; }
        .error { border-color: #dc3545; background-color: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>ğŸ§ª ãƒã‚¹ã‚³ãƒƒãƒˆAPI ãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="test-section">
        <h3>ğŸ“Š ãƒã‚¹ã‚³ãƒƒãƒˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å–å¾—</h3>
        <button onclick="testGetStatus()">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å–å¾—</button>
        <div id="status-result" class="result"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ™ ãƒã‚¹ã‚³ãƒƒãƒˆçµ¦é¤Œ</h3>
        <button onclick="testFeed()">çµ¦é¤Œã™ã‚‹</button>
        <div id="feed-result" class="result"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ¾ ãƒã‚¹ã‚³ãƒƒãƒˆã¨éŠã¶</h3>
        <button onclick="testPlay()">éŠã¶</button>
        <div id="play-result" class="result"></div>
    </div>

    <div class="test-section">
        <h3>âœ‹ ãƒã‚¹ã‚³ãƒƒãƒˆã‚’ãªã§ã‚‹</h3>
        <button onclick="testPet()">ãªã§ã‚‹</button>
        <div id="pet-result" class="result"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ”„ å…¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é€£ç¶šãƒ†ã‚¹ãƒˆ</h3>
        <button onclick="testAll()">å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</button>
        <div id="all-result" class="result"></div>
    </div>

    <script>
        // APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆã‚·ãƒ³ãƒ—ãƒ«ç‰ˆï¼‰
        class SimpleMascotAPI {
            constructor() {
                this.baseUrl = 'http://localhost:8000/api/mascot';
            }

            async request(endpoint, method = 'GET', data = null) {
                try {
                    const options = {
                        method,
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json'
                        }
                    };

                    if (data && method !== 'GET') {
                        options.body = JSON.stringify(data);
                    }

                    const response = await fetch(`${this.baseUrl}${endpoint}`, options);
                    const result = await response.json();
                    
                    return {
                        ok: response.ok,
                        status: response.status,
                        data: result
                    };
                } catch (error) {
                    return {
                        ok: false,
                        error: error.message
                    };
                }
            }

            async getStatus() {
                return await this.request('/status');
            }

            async feed() {
                return await this.request('/feed', 'POST', {});
            }

            async play() {
                return await this.request('/play', 'POST', {});
            }

            async pet() {
                return await this.request('/pet', 'POST', {});
            }
        }

        const api = new SimpleMascotAPI();

        function displayResult(elementId, result, success = true) {
            const element = document.getElementById(elementId);
            element.textContent = JSON.stringify(result, null, 2);
            element.className = `result ${success ? 'success' : 'error'}`;
        }

        async function testGetStatus() {
            const result = await api.getStatus();
            displayResult('status-result', result, result.ok);
        }

        async function testFeed() {
            const result = await api.feed();
            displayResult('feed-result', result, result.ok);
        }

        async function testPlay() {
            const result = await api.play();
            displayResult('play-result', result, result.ok);
        }

        async function testPet() {
            const result = await api.pet();
            displayResult('pet-result', result, result.ok);
        }

        async function testAll() {
            const allElement = document.getElementById('all-result');
            allElement.textContent = 'ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...';
            allElement.className = 'result';

            const results = {};

            // åˆæœŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
            results.initialStatus = await api.getStatus();
            await new Promise(resolve => setTimeout(resolve, 500));

            // çµ¦é¤Œ
            results.feed = await api.feed();
            await new Promise(resolve => setTimeout(resolve, 500));

            // éŠã¶
            results.play = await api.play();
            await new Promise(resolve => setTimeout(resolve, 500));

            // ãªã§ã‚‹
            results.pet = await api.pet();
            await new Promise(resolve => setTimeout(resolve, 500));

            // æœ€çµ‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
            results.finalStatus = await api.getStatus();

            // çµæœè¡¨ç¤º
            displayResult('all-result', results, true);
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å–å¾—
        window.addEventListener('load', () => {
            testGetStatus();
        });
    </script>
</body>
</html>